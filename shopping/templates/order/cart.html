{% extends "base.html" %}

{% block content %}
<div class="container">

<div class="row">
<form method="post" action="{% url 'cart_number_update' %}">
	{% csrf_token %}
	<table class="table">
		<thead>
			<tr>
				<th>사진</th>
				<th>아이템-옵션</th>
				<th>가격</th>
				<th>개수</th>
				<th>합계</th>
				<th>삭제</th>
			</tr>
		</thead>
		<tbody>
			{% for cart_item in cart_items %}
			<tr>
				<input type="text" name="id" value="{{cart_item.id}}" style="display:none;"/>
				<td><img style="max-width:80px;" src="{{cart_item.item.image0.url}}"/></td>
				<td>{{ cart_item.item }} : {{ cart_item.item_option }}( +{{cart_item.item_option.option_price}} ) </td>
				<td>{{cart_item.item_plus_option_price}}</td>
				<td style="max-width:110px;">
					<div class="input-group">
					  <div class="input-group-btn">
					    <a class="btn btn-default option_plus">+</a>
					  </div>
					  <input type="text" class="form-control" id="quantity" name="quantity" value = "{{cart_item.quantity}}">
					  <div class="input-group-btn">
					    <a class="btn btn-default option_minus">-</a>
					  </div>
					</div>
				</td>
				<td>{{cart_item.sub_total_price}}</td>
				<td><a class="btn btn-default" href="/order/pop_item/?id={{cart_item.id}}">삭제</a></td>
			</tr>
			{% endfor %}
			<tr>
				<td colspan="5">합계</td>
				<td>{{ total_price }}</td>
			</tr>
		</tbody>
	</table>
	<div>
		<a href="{% url 'order_info' %}" class="btn btn-primary">구매하기</a>
		<button class="btn btn-primary" type="submit">수정</button>
	</div>
</form>
</div>

<script>
$(function() {
	    $('.option_plus').click(function(e){
        stockInput = $(this).parent().next();
        var currentVal = parseInt(stockInput.val());
        var next = currentVal+1;
        stockInput.val(next);
    });
	    $('.option_minus').click(function(e){
        stockInput = $(this).parent().prev();
        var currentVal = parseInt(stockInput.val());
        var next = currentVal-1;
        if(currentVal==1){
        	next = 1;
        }
        stockInput.val(next);
    });
});
</script>
</div>
{% endblock %}